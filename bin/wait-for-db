#! /bin/sh

limit=5
count=0

until timeout 5 bash -c 'cat < /dev/null > /dev/tcp/db/5432'; do
  if [[ $count -lt $limit ]]; then
    echo "Connection to database failed, trying again..."
    count=$((count+1))
  else
    echo "Failed to connect to database 5 times, continuing."
  fi
done
